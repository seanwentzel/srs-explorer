{"mappings":"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","sources":["src/index.ts"],"sourcesContent":["const possibleEvents = new Set([\"input\", \"onpropertychange\"]);\nconst inputs = [\"start_string\", \"in_string\", \"out_string\"];\nlet start = \"\";\nlet in_string = \"\";\nlet out_string = \"\";\n\nwindow.onload = () => {\n    readParams();\n    inputs.forEach((input: string) => {\n        possibleEvents.forEach((eventName: string) => {\n            const inputElement = document.getElementById(input) as HTMLInputElement;\n            inputElement.addEventListener(eventName, (ev: Event) => {\n                handleInput();\n            })\n        });\n        handleInput();\n    });\n};\n\nfunction readParams(): void {\n    const params = new URL(window.location.href).searchParams;\n    let noop = true;\n    inputs.forEach((input: string) => {\n        const inputElement = document.getElementById(input) as HTMLInputElement;\n        const value = params.get(input);\n        if (value) {\n            inputElement.value = value;\n            noop = false;\n        }\n    });\n    handleInput();\n}\n\nfunction setUrl(): void {\n    const url = new URL(window.location.href);\n    inputs.forEach((input: string) => {\n        const inputElement = document.getElementById(input) as HTMLInputElement;\n        url.searchParams.set(input, inputElement.value);\n    });\n    history.pushState({}, \"\", url);\n}\n\nfunction read(id: string): string {\n    return (document.getElementById(id) as HTMLInputElement).value;\n}\n\nfunction renderResultStringHtml(result: Result) {\n    if (result.loop_of === null) {\n        return result.s;\n    } else {\n        const idx = result.s.indexOf(result.loop_of);\n        return `${result.s.substring(0,idx)}<b>${result.loop_of}</b>${result.s.substring(idx+result.loop_of.length)}`;\n    }\n}\n\nfunction handleInput() {\n    const new_start = read(\"start_string\");\n    const new_in_string = read(\"in_string\");\n    const new_out_string = read(\"out_string\");\n    if(new_in_string !== \"\" && (new_start !== start || new_in_string !== in_string || new_out_string !== out_string)) {\n        start = new_start;\n        in_string = new_in_string;\n        out_string = new_out_string;\n        const results = generateResults(start, in_string, out_string);\n        const lis = results.map((result: Result) => `<li>${result.depth}: ${renderResultStringHtml(result)} </li>`);\n        const ul = `<ul>${lis.join(\"\")}</ul>`\n        const output = document.getElementById(\"output\") as HTMLElement;\n        output.innerHTML = ul;\n        setUrl();\n    }\n}\n\ntype Result = {\n    s: string;\n    parents: Set<string>;\n    depth: number;\n    loop_of: string | null;\n}\n\nfunction findLoop(universe: Map<string, Result>, res: Result, haystack: string): string | null {\n    const bfs = [res];\n    let at = 0;\n    const visited = new Set();\n    while(at < bfs.length) {\n        res = bfs[at];\n        if (haystack.indexOf(res.s) !== -1) {\n            return res.s;\n        }\n        for(const parent of res.parents) {\n            if(!visited.has(parent)) {\n                bfs.push(universe.get(parent) as Result);\n                visited.add(parent);\n            }\n        }\n        at ++;\n    }\n    return null;\n}\n\nfunction* children(universe: Map<string, Result>, result: Result, in_string: string, out_string: string) {\n    let at = result.s.indexOf(in_string);\n    while (at !== -1) {\n        const replaced = result.s.substring(0, at) + out_string + result.s.substring(at+in_string.length);\n        const loop_of = findLoop(universe, result, replaced);\n        const parents = new Set();\n        parents.add(result.s);\n        yield {\n            s: replaced,\n            parents,\n            depth: result.depth + 1,\n            loop_of\n        };\n        at = result.s.indexOf(in_string, at + 1);\n      }\n}\n\nfunction generateResults(start: string, in_string: string, out_string: string): Result[] {\n    const firstResult: Result = {\n        s: start,\n        parents: new Set(),\n        depth: 0,\n        loop_of: null\n    }\n    const universe = new Map();\n    const queue = [firstResult];\n    universe.set(start, firstResult);\n    let at = 0;\n    while(at < queue.length && at < 500) {\n        if(queue[at].loop_of === null) {\n            for(let res of children(universe, queue[at], in_string, out_string)) {\n                if(!universe.has(res.s)) {\n                    queue.push(res);\n                    universe.set(res.s, res);\n                } else {\n                    const element = universe.get(res.s);\n                        element.parents.add(queue[at].s);\n                        if(element.loop_of === null) {\n                            element.loop_of = res.loop_of;\n                        }\n\n                }\n            }\n        }\n        at += 1;\n    }\n    return queue;\n}"],"names":[],"version":3,"file":"index.377278e2.js.map","sourceRoot":"/__parcel_source_root/"}